(function(e){function t(t){for(var a,o,i=t[0],c=t[1],l=t[2],f=0,p=[];f<i.length;f++)o=i[f],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&p.push(r[o][0]),r[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e[a]=c[a]);u&&u(t);while(p.length)p.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var e,t=0;t<s.length;t++){for(var n=s[t],a=!0,i=1;i<n.length;i++){var c=n[i];0!==r[c]&&(a=!1)}a&&(s.splice(t--,1),e=o(o.s=n[0]))}return e}var a={},r={app:0},s=[];function o(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=a,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)o.d(n,a,function(t){return e[t]}.bind(null,a));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/restaurant-map-app/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;s.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"0c64":function(e,t,n){},3423:function(e,t,n){"use strict";n("0c64")},"3ea9":function(e,t,n){"use strict";n("6b28")},5098:function(e,t,n){"use strict";n("f286")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("7a23"),r={class:"map-container"};function s(e,t,n,s,o,i){var c=Object(a["m"])("Map");return Object(a["h"])(),Object(a["c"])("div",r,[Object(a["f"])(c)])}var o=Object(a["t"])("data-v-f95d9eaa");Object(a["j"])("data-v-f95d9eaa");var i={id:"map",ref:"map"};Object(a["i"])();var c=o((function(e,t,n,r,s,o){var c=Object(a["m"])("InfoPanel"),l=Object(a["m"])("RestaurantList");return Object(a["h"])(),Object(a["c"])(a["a"],null,[Object(a["f"])("div",i,null,512),Object(a["f"])(c),Object(a["f"])(l,{onListMark:o.listConnectMark},null,8,["onListMark"])],64)})),l=(n("d81d"),n("159b"),n("b0c0"),n("b680"),Object(a["t"])("data-v-66264f3e"));Object(a["j"])("data-v-66264f3e");var u={class:"card-box"},f={class:"restaurant-list"},p={class:"name"},d=Object(a["f"])("br",null,null,-1),b=Object(a["f"])("span",null,[Object(a["e"])("餐"),Object(a["f"])("br"),Object(a["e"])("廳"),Object(a["f"])("br"),Object(a["e"])("列"),Object(a["f"])("br"),Object(a["e"])("表")],-1);Object(a["i"])();var m=l((function(e,t,n,r,s,o){var i=Object(a["m"])("FilterBar");return o.filterByfilterType?(Object(a["h"])(),Object(a["c"])("div",{key:0,class:["restaurant-list-card",{open:s.listOpen}]},[Object(a["f"])("div",u,[Object(a["f"])(i),Object(a["f"])("ul",f,[(Object(a["h"])(!0),Object(a["c"])(a["a"],null,Object(a["l"])(o.filterByfilterType,(function(e){return Object(a["h"])(),Object(a["c"])("li",{class:{active:o.nowRestaurant===e.name},onClick:function(t){return o.showInfo(e)},key:e.name},[Object(a["f"])("span",p,Object(a["n"])(e.name),1),d,Object(a["s"])(Object(a["f"])("span",null,"距離："+Object(a["n"])(e.distance)+" m",513),[[a["q"],"distance"===o.filterType]]),Object(a["s"])(Object(a["f"])("span",null,"評價："+Object(a["n"])(e.rating),513),[[a["q"],"rating"===o.filterType]])],10,["onClick"])})),128))])]),Object(a["f"])("div",{onClick:t[1]||(t[1]=function(e){return s.listOpen=!s.listOpen}),id:"trigger-button"},[b])],2)):Object(a["d"])("",!0)})),O=(n("4de4"),Object(a["t"])("data-v-546c54e0"));Object(a["j"])("data-v-546c54e0");var h={class:"filter-nav"},j={class:"box"},v=Object(a["f"])("label",{for:"distance"},"距離",-1),g={class:"box"},y=Object(a["f"])("label",{for:"rating"},"評價",-1),k={class:"box radius"},w=Object(a["f"])("label",{for:"radius"},"範圍：",-1),$=Object(a["f"])("span",null,"公尺",-1);Object(a["i"])();var M=O((function(e,t,n,r,s,o){return Object(a["h"])(),Object(a["c"])("nav",h,[Object(a["f"])("div",j,[Object(a["s"])(Object(a["f"])("input",{"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.filterType=e}),type:"radio",id:"distance",name:"filter",value:"distance"},null,512),[[a["o"],o.filterType]]),v]),Object(a["f"])("div",g,[Object(a["s"])(Object(a["f"])("input",{"onUpdate:modelValue":t[2]||(t[2]=function(e){return o.filterType=e}),type:"radio",id:"rating",name:"filter",value:"rating"},null,512),[[a["o"],o.filterType]]),y]),Object(a["f"])("div",k,[w,Object(a["s"])(Object(a["f"])("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=function(e){return o.radius=e}),id:"radius",name:"radius",placeholder:"EX: 3000"},null,512),[[a["p"],o.radius]]),$])])})),I={computed:{filterType:{get:function(){return this.$store.state.filterType},set:function(e){this.$store.commit("setState",{type:"filterType",val:e})}},radius:{get:function(){return this.$store.state.radius},set:function(e){this.$store.commit("setState",{type:"radius",val:e})}}}};n("b747");I.render=M,I.__scopeId="data-v-546c54e0";var _=I,P={components:{FilterBar:_},data:function(){return{listOpen:!1}},computed:{filterByfilterType:function(){return this.$store.getters.filterByfilterType},filterType:function(){return this.$store.state.filterType},nowRestaurant:function(){return this.$store.state.nowRestaurant}},methods:{showInfo:function(e){var t=this.$store.state.allMarkers.filter((function(t){return t.title===e.name}))[0],n={placeId:e.place_id,marker:t};this.$emit("listMark",n)}}};n("5098");P.render=m,P.__scopeId="data-v-66264f3e";var S=P,T=Object(a["t"])("data-v-37a9afa7");Object(a["j"])("data-v-37a9afa7");var x={key:0,class:"panel-box"},B=Object(a["f"])("span",null,"X",-1),C={class:"place"},L={class:"details"},R={class:"details"},E={class:"details"},U={key:1,class:"details"},A=Object(a["e"])("電話："),D={key:2},N=Object(a["e"])(" 網站：");Object(a["i"])();var F=T((function(e,t,n,r,s,o){return Object(a["h"])(),Object(a["c"])("div",{id:"panel",class:{open:o.panelOpen}},[o.placeInfo?(Object(a["h"])(),Object(a["c"])("div",x,[Object(a["f"])("div",{onClick:t[1]||(t[1]=function(){return o.panelClose&&o.panelClose.apply(o,arguments)}),id:"close-btn"},[B]),o.placeInfo.photos[0].getUrl()?(Object(a["h"])(),Object(a["c"])("img",{key:0,src:o.placeInfo.photos[0].getUrl(),style:{width:"100%"}},null,8,["src"])):Object(a["d"])("",!0),Object(a["f"])("h1",C,Object(a["n"])(o.placeInfo.name),1),Object(a["f"])("p",L,"評價："+Object(a["n"])(o.placeInfo.rating),1),Object(a["f"])("p",R,"地址："+Object(a["n"])(o.placeInfo.formatted_address),1),Object(a["f"])("p",E,"距離："+Object(a["n"])(o.placeInfo.distance)+" 公尺",1),o.placeInfo.formatted_phone_number?(Object(a["h"])(),Object(a["c"])("p",U,[A,Object(a["f"])("a",{href:"tel:".concat(o.placeInfo.formatted_phone_number)},Object(a["n"])(o.placeInfo.formatted_phone_number),9,["href"])])):Object(a["d"])("",!0),o.placeInfo.website?(Object(a["h"])(),Object(a["c"])("p",D,[N,Object(a["f"])("a",{href:o.placeInfo.website},Object(a["n"])(o.placeInfo.website),9,["href"])])):Object(a["d"])("",!0)])):Object(a["d"])("",!0)],2)})),z={computed:{placeInfo:function(){return this.$store.state.placeInfo},nowPanel:function(){return this.$store.state.nowPanel},panelOpen:function(){return this.$store.state.panelOpen}},methods:{panelClose:function(){this.$store.commit("setState",{type:"panelOpen",val:!1}),this.$store.state.nowMarker.setAnimation(null)}}};n("e2f6");z.render=F,z.__scopeId="data-v-37a9afa7";var H=z,V={components:{RestaurantList:S,InfoPanel:H},data:function(){return{userMarker:null,defaultMapCanter:{lat:25.0059349,lng:121.4215651},userPosition:{lat:null,lng:null}}},computed:{radius:function(){return this.$store.state.radius}},watch:{radius:function(e){e>0&&this.checkNearbyRestaurant(this.userPosition,e)}},methods:{mapInit:function(){this.$store.state.bounds=new google.maps.LatLngBounds,this.$store.state.infoPane=this.$refs["panel"],this.$store.state.map=new google.maps.Map(this.$refs["map"],{center:this.defaultMapCanter,zoom:15}),this.checkUserLocation()},checkUserLocation:function(){var e=this;navigator.geolocation?navigator.geolocation.getCurrentPosition((function(t){var n={lat:t.coords.latitude,lng:t.coords.longitude};e.userPosition=n,e.$store.state.bounds.extend(e.userPosition),e.setUserMarker(),e.$store.state.map.setCenter(e.userPosition),e.checkNearbyRestaurant(e.userPosition,e.radius)})):console.log("Browser doesn't support Geolocation")},setUserMarker:function(){var e={url:n("a67c"),scaledSize:new google.maps.Size(80,80)};this.userMarker=new google.maps.Marker({position:this.userPosition,icon:e,map:this.$store.state.map})},createMarkers:function(e){var t=this;this.clearMarker(),e.forEach((function(e){t.$store.state.mapMarker=new google.maps.Marker({position:e.geometry.location,map:t.$store.state.map,animation:google.maps.Animation.DROP,title:e.name}),t.$store.state.allMarkers.push(t.$store.state.mapMarker),t.markerEventHandler(e.place_id,t.$store.state.mapMarker),t.$store.state.bounds.extend(e.geometry.location)})),this.$store.state.map.fitBounds(this.$store.state.bounds)},markerEventHandler:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];google.maps.event.addListener(t,"click",(function(){var a={placeId:e,fields:["name","formatted_address","geometry","rating","website","photos","formatted_phone_number","opening_hours","utc_offset_minutes"]};n.$store.state.service.getDetails(a,(function(e,a){n.resultHandler(e,t,a)}))})),a&&new google.maps.event.trigger(t,"click")},markerActive:function(e){this.$store.state.allMarkers.forEach((function(e){e.setAnimation(null)})),e.setAnimation(google.maps.Animation.BOUNCE)},clearMarker:function(){this.$store.state.allMarkers.forEach((function(e){e.setMap(null),e.setVisible(!1)})),this.$store.state.allMarkers=[]},checkNearbyRestaurant:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1500,a={location:e,radius:n,keyword:"restaurant"},r=function(e,n){n==google.maps.places.PlacesServiceStatus.OK&&(t.calcDistance(e),t.createMarkers(e),t.$store.commit("setState",{type:"resultList",val:e}))};this.$store.state.service=new google.maps.places.PlacesService(this.$store.state.map),this.$store.state.service.nearbySearch(a,r)},resultHandler:function(e,t,n){n==google.maps.places.PlacesServiceStatus.OK?(this.calcDistance(e),this.markerActive(t),this.$store.commit("setState",{type:"nowRestaurant",val:t.title}),this.$store.commit("setState",{type:"nowMarker",val:t}),this.$store.commit("setState",{type:"panelOpen",val:!0}),this.$store.commit("setState",{type:"placeInfo",val:e})):console.log("showDetails failed: "+n)},calcDistance:function(e){var t=0,n=new google.maps.LatLng(this.userPosition.lat,this.userPosition.lng);Array.isArray(e)?e.forEach((function(e){t=google.maps.geometry.spherical.computeDistanceBetween(n,e.geometry.location),e.distance="".concat(parseFloat(t.toFixed(1)))})):(t=google.maps.geometry.spherical.computeDistanceBetween(n,e.geometry.location),e.distance="".concat(parseFloat(t.toFixed(1))))},listConnectMark:function(e){this.markerEventHandler(e.placeId,e.marker,!0)}},mounted:function(){var e=this,t=document.createElement("script");t.src="https://maps.googleapis.com/maps/api/js?key=".concat("AIzaSyCd6kNCPNNnVZnd45Es3WTY8xfzeYdhUQQ","&libraries=geometry,places&callback=initMap"),document.body.appendChild(t),window["initMap"]=function(){e.mapInit()}}};n("3ea9");V.render=c,V.__scopeId="data-v-f95d9eaa";var q=V,J={components:{Map:q}};n("3423");J.render=s;var K=J,Q=n("2909"),X=n("5502"),Y=Object(X["a"])({state:{map:null,bounds:null,infoPane:null,service:null,mapMarker:null,allMarkers:[],nowMarker:null,resultList:null,placeInfo:null,nowRestaurant:"",panelOpen:!1,radius:1500,filterType:""},mutations:{setState:function(e,t){var n=t.type,a=t.val;e[n]=a}},getters:{filterByRating:function(e){return Object(Q["a"])(e.resultList).sort((function(e,t){return t.rating-e.rating}))},filterByDistance:function(e){return Object(Q["a"])(e.resultList).sort((function(e,t){return e.distance-t.distance}))},filterByfilterType:function(e,t){switch(e.filterType){case"distance":return t.filterByDistance;case"rating":return t.filterByRating;default:return e.resultList}}}});Object(a["b"])(K).use(Y).mount("#app")},"654e":function(e,t,n){},"6b28":function(e,t,n){},a67c:function(e,t,n){e.exports=n.p+"img/robot.6f5ac4fc.png"},b747:function(e,t,n){"use strict";n("d5e6")},d5e6:function(e,t,n){},e2f6:function(e,t,n){"use strict";n("654e")},f286:function(e,t,n){}});
//# sourceMappingURL=app.f9eb804a.js.map